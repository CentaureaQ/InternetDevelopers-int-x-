import{d as x,u as C,r as g,a as R,c as z,b as n,e as o,w as t,f as s,o as S,g as q,h as B,i as E,j as N,k as w,E as p}from"./index-BM9eJQOU.js";import{l as T}from"./user-CGswJQa2.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-CZgcLb5a.js";const I={class:"login-page"},K={class:"login-container"},L=x({__name:"Login",setup(M){const c=q(),v=B(),y=C(),u=g(!1),i=g(),r=R({username:"",password:""}),b={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]};async function d(){i.value&&await i.value.validate(async f=>{if(f)try{u.value=!0;const e=await T(r);if(!e||!e.token){p.error("登录失败：未获取到token");return}y.login(e),p.success("登录成功"),setTimeout(()=>{const a=v.query.redirect||"/console/agents";c.replace(a)},500)}catch(e){console.error("登录失败:",e),p.error(e.message||"登录失败，请重试")}finally{u.value=!1}})}function V(){c.push("/register")}return(f,e)=>{const a=s("el-input"),l=s("el-form-item"),_=s("el-button"),k=s("el-form"),h=s("el-card");return S(),z("div",I,[n("div",K,[e[4]||(e[4]=n("div",{class:"login-header"},[n("h1",null,"智能体创作平台"),n("p",null,"搭建您的专属AI智能体")],-1)),o(h,{class:"login-card"},{default:t(()=>[o(k,{model:r,rules:b,ref_key:"formRef",ref:i,onSubmit:E(d,["prevent"])},{default:t(()=>[o(l,{label:"用户名",prop:"username"},{default:t(()=>[o(a,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=m=>r.username=m),placeholder:"请输入用户名",size:"large"},null,8,["modelValue"])]),_:1}),o(l,{label:"密码",prop:"password"},{default:t(()=>[o(a,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=m=>r.password=m),type:"password",placeholder:"请输入密码",size:"large",onKeyup:N(d,["enter"])},null,8,["modelValue"])]),_:1}),o(l,null,{default:t(()=>[o(_,{type:"primary",size:"large",style:{width:"100%"},loading:u.value,onClick:d},{default:t(()=>[...e[2]||(e[2]=[w(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),o(l,null,{default:t(()=>[o(_,{size:"large",style:{width:"100%"},onClick:V},{default:t(()=>[...e[3]||(e[3]=[w("注册账号",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}}),G=U(L,[["__scopeId","data-v-ef6018d5"]]);export{G as default};
