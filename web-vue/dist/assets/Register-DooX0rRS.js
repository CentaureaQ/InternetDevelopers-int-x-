import{d as k,r as c,a as P,c as x,e as a,w as o,f as d,o as C,i as E,k as g,b as _,E as w,g as R}from"./index-BM9eJQOU.js";import{r as U}from"./user-CGswJQa2.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./http-CZgcLb5a.js";const B={class:"register-page"},N={class:"card-header"},T=k({__name:"Register",setup(M){const p=R(),i=c(!1),m=c(),r=P({username:"",password:"",confirmPassword:"",nickname:"",email:""}),V={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]{4,16}$/,message:"用户名4-16位字母数字下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}],confirmPassword:[{validator:(u,e,s)=>{e?e!==r.password?s(new Error("两次密码输入不一致")):s():s(new Error("请输入确认密码"))},trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],email:[{type:"email",message:"邮箱格式不正确",trigger:"blur"}]};async function f(){m.value&&await m.value.validate(async u=>{if(u)try{i.value=!0,await U({username:r.username,password:r.password,nickname:r.nickname,email:r.email||void 0}),w.success("注册成功，请登录"),setTimeout(()=>{p.replace("/login")},1500)}catch(e){console.error("注册失败:",e),w.error(e.message||"注册失败，请重试")}finally{i.value=!1}})}function b(){p.push("/login")}return(u,e)=>{const s=d("el-button"),n=d("el-input"),t=d("el-form-item"),v=d("el-form"),y=d("el-card");return C(),x("div",B,[a(y,{class:"register-card"},{header:o(()=>[_("div",N,[e[6]||(e[6]=_("span",null,"注册账号",-1)),a(s,{text:"",onClick:b},{default:o(()=>[...e[5]||(e[5]=[g("已有账号？去登录",-1)])]),_:1})])]),default:o(()=>[a(v,{model:r,rules:V,ref_key:"formRef",ref:m,onSubmit:E(f,["prevent"])},{default:o(()=>[a(t,{label:"用户名",prop:"username"},{default:o(()=>[a(n,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=l=>r.username=l),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),a(t,{label:"密码",prop:"password"},{default:o(()=>[a(n,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=l=>r.password=l),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),a(t,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[a(n,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),a(t,{label:"昵称",prop:"nickname"},{default:o(()=>[a(n,{modelValue:r.nickname,"onUpdate:modelValue":e[3]||(e[3]=l=>r.nickname=l),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),a(t,{label:"邮箱",prop:"email"},{default:o(()=>[a(n,{modelValue:r.email,"onUpdate:modelValue":e[4]||(e[4]=l=>r.email=l),type:"email",placeholder:"请输入邮箱（选填）"},null,8,["modelValue"])]),_:1}),a(t,null,{default:o(()=>[a(s,{type:"primary",style:{width:"100%"},loading:i.value,onClick:f},{default:o(()=>[...e[7]||(e[7]=[g("注册",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}}),L=q(T,[["__scopeId","data-v-ccdf96ca"]]);export{L as default};
