import{d as D,r as b,a as U,z as M,c as T,e,w as l,f as s,o as V,i as $,k as c,b as g,A as z,B as J,C as G,t as v,E as r,y as j}from"./index-BM9eJQOU.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"page-container"},C="console_plugins",L=D({__name:"PluginConsole",setup(R){const i=b([]),h=b(!1),m=b(!1),n=U({name:"",description:"",type:"custom",openapiSpec:""});function k(){const o=localStorage.getItem(C);if(o)try{i.value=JSON.parse(o)}catch(t){console.error("解析插件数据失败",t),i.value=[]}else i.value=[]}function _(){localStorage.setItem(C,JSON.stringify(i.value))}async function y(){if(!n.name){r.warning("请填写插件名称");return}m.value=!0;try{const o={id:`plg_${Date.now()}`,name:n.name,description:n.description,type:n.type,status:"disabled",openapiSpec:n.openapiSpec,createdAt:new Date().toISOString()};i.value.push(o),_(),r.success("注册成功"),Object.assign(n,{name:"",description:"",openapiSpec:""})}catch(o){console.error("注册插件失败",o)}finally{m.value=!1}}function P(o){o.status=o.status==="enabled"?"disabled":"enabled",_(),r.success(`插件已${o.status==="enabled"?"启用":"禁用"}`)}function B(o){j.confirm("确定要删除该插件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=i.value.findIndex(p=>p.id===o.id);t!==-1&&(i.value.splice(t,1),_(),r.success("删除成功"))}).catch(()=>{})}return M(()=>{k()}),(o,t)=>{const p=s("el-input"),u=s("el-form-item"),w=s("el-option"),I=s("el-select"),f=s("el-button"),O=s("el-form"),S=s("el-card"),d=s("el-table-column"),x=s("el-tag"),N=s("el-table"),A=J("loading");return V(),T("div",K,[e(S,{class:"card-container mb-16"},{header:l(()=>[...t[4]||(t[4]=[g("div",{class:"flex-between"},[g("span",null,"注册插件")],-1)])]),default:l(()=>[e(O,{model:n,"label-width":"120px",onSubmit:$(y,["prevent"])},{default:l(()=>[e(u,{label:"插件名称",required:""},{default:l(()=>[e(p,{modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=a=>n.name=a),placeholder:"请输入插件名称"},null,8,["modelValue"])]),_:1}),e(u,{label:"描述"},{default:l(()=>[e(p,{modelValue:n.description,"onUpdate:modelValue":t[1]||(t[1]=a=>n.description=a),type:"textarea",rows:2,placeholder:"插件描述"},null,8,["modelValue"])]),_:1}),e(u,{label:"插件类型"},{default:l(()=>[e(I,{modelValue:n.type,"onUpdate:modelValue":t[2]||(t[2]=a=>n.type=a),placeholder:"选择类型"},{default:l(()=>[e(w,{label:"内置",value:"builtin"}),e(w,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"OpenAPI规范"},{default:l(()=>[e(p,{modelValue:n.openapiSpec,"onUpdate:modelValue":t[3]||(t[3]=a=>n.openapiSpec=a),type:"textarea",rows:8,placeholder:"粘贴OpenAPI 3.0规范JSON内容"},null,8,["modelValue"])]),_:1}),e(u,null,{default:l(()=>[e(f,{type:"primary",loading:m.value,onClick:y},{default:l(()=>[...t[5]||(t[5]=[c("注册插件",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),e(S,{class:"card-container"},{header:l(()=>[...t[6]||(t[6]=[g("span",null,"插件列表",-1)])]),default:l(()=>[z((V(),G(N,{data:i.value,style:{width:"100%"}},{default:l(()=>[e(d,{prop:"name",label:"插件名称",width:"200"}),e(d,{prop:"description",label:"描述","show-overflow-tooltip":""}),e(d,{prop:"type",label:"类型",width:"100"},{default:l(({row:a})=>[e(x,{type:a.type==="builtin"?"success":"info"},{default:l(()=>[c(v(a.type),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"status",label:"状态",width:"120"},{default:l(({row:a})=>[e(x,{type:a.status==="enabled"?"success":"info"},{default:l(()=>[c(v(a.status),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"createdAt",label:"创建时间",width:"180"}),e(d,{label:"操作",width:"150",fixed:"right"},{default:l(({row:a})=>[e(f,{size:"small",onClick:E=>P(a)},{default:l(()=>[c(v(a.status==="enabled"?"禁用":"启用"),1)]),_:2},1032,["onClick"]),e(f,{size:"small",type:"danger",onClick:E=>B(a)},{default:l(()=>[...t[7]||(t[7]=[c("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,h.value]])]),_:1})])}}}),H=q(L,[["__scopeId","data-v-5fcc5b84"]]);export{H as default};
